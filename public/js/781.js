"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[781],{3391:(t,e,s)=>{s.d(e,{Z:()=>n});var r=s(3645),o=s.n(r)()((function(t){return t[1]}));o.push([t.id,".results{padding-left:15px}.results-card{margin:6px;padding:9px}.csl-bib-body{color:#000;font-weight:500}.csl-bib-body:hover{color:#639}.vue-treeselect__multi-value-item{background-color:#639;color:#fff}",""]);const n=o},1781:(t,e,s)=>{s.r(e),s.d(e,{default:()=>g});var r=s(7757),o=s.n(r),n=s(893),a=s.n(n);s(2854);function i(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,r=new Array(e);s<e;s++)r[s]=t[s];return r}function l(t,e,s,r,o,n,a){try{var i=t[n](a),c=i.value}catch(t){return void s(t)}i.done?e(c):Promise.resolve(c).then(r,o)}const u={name:"tree-subject",props:["dataChildren","ids"],data:function(){return{data:null,value:[],registros:[],subjects:[],treeselectOptions:[],nodes:[],total:0,showSubjects:!0,options:[]}},beforeMount:function(){this.getSubjects()},mounted:function(){var t=this;this.$nextTick((function(){t.value=t.ids}))},created:function(){console.log(this.$refs),this.subjects.length>0&&(this.value.push(this.subject.id),this.data=this.subject.children),this.data.length>0&&this.SearchRegistros(this.value)},afterCreate:function(){this.$refs.vueTree.forest.selectedNodeIds=this.ids},computed:{},components:{Treeselect:a()},methods:{getSubjects:function(){var t,e=this;return(t=o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,axios.get("/subjectindex").then((function(t){e.data=[],t.data[0].children.forEach((function(t){e.data.push(t)}))}));case 2:case"end":return t.stop()}}),t)})),function(){var e=this,s=arguments;return new Promise((function(r,o){var n=t.apply(e,s);function a(t){l(n,r,o,a,i,"next",t)}function i(t){l(n,r,o,a,i,"throw",t)}a(void 0)}))})()},changes:function(t,e){var s;(this.value=[],t.length>0)?((s=this.value).push.apply(s,i(t)),this.SearchRegistros(t)):this.registros=[];this.updateRoute()},loadRegistrosInSubject:function(t){var e=this;t.children.forEach((function(t){e.loadRegistrosInSubject(t)})),"registros"in t&&t.registros.forEach((function(t){e.registros.push(t)}))},SearchRegistros:function(t){var e=this;this.nodes=t,axios.get("/registroArray",{params:{ids:this.nodes}}).then((function(t){var s;e.page=1,e.total=t.data.total,(s=e.registros).push.apply(s,i(t.data.data))}))},loadMore:function(){var t=this;this.page++,axios.get("/registroArray",{params:{ids:this.nodes,page:this.page}}).then((function(e){var s;(s=t.registros).push.apply(s,i(e.data.data))}))},updateRoute:function(){var t=new URL(window.location.origin+window.location.pathname);console.log(window.location),console.log(window.location.href),console.log(t),console.log(this.nodes),this.nodes.length>0&&this.nodes.forEach((function(e){t.searchParams.append("ids[]",e)})),history.pushState(null,"",t),console.log(t)},toggleSubjects:function(){this.showSubjects=!this.showSubjects}}};var d=s(3379),h=s.n(d),p=s(3391),f={insert:"head",singleton:!1};h()(p.Z,f);p.Z.locals;const g=(0,s(1900).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",[s("div",{staticClass:"container"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"pt-4 card card-border-primary",class:[0===t.registros.length?"col-md-12":"col-md-4"],staticStyle:{border:"3px solid rebeccapurple"}},[t.registros.length>0?s("div",{staticClass:"card-header"},[s("div",{staticClass:"badge badge-pill badge-black"},[t._v(t._s(t.total)+" registros")])]):t._e(),t._v(" "),s("div",{staticClass:"card-body text-success",scopedSlots:t._u([{key:"option-label",fn:function(e){var r=e.node,o=(e.shouldShowCount,e.count,e.labelClassName);e.countClassName;return s("label",{class:o},[t._v("\n                        "+t._s(r.label)+" - Description: "+t._s(r.raw.desc)+"\n                    ")])}}])},[s("h2",{staticClass:"card-title"},[t._v("Búsqueda por el árbol de terminos clave")]),t._v(" "),s("treeselect",{ref:"vueTree",staticClass:"tree",attrs:{multiple:!0,options:t.data,loading:!0,showCount:!1,openOnFocus:!0,closeOnSelect:!1,placeholder:"Haz click para comenzar...",instanceId:"subjects"},on:{input:t.changes},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t._v(" "),t._v(" "),s("p",{staticClass:"card-text",staticStyle:{color:"rebeccapurple"}},[t._v("Estos son los registros publicados durante el último mes")])],1)]),t._v(" "),t.registros.length>0?s("div",{class:[0===t.registros.length?"col-md-1":"col-md-8"]},[s("div",{staticClass:"row justify-content-center results"},[s("div",{staticClass:"btn btn-outline",on:{click:t.toggleSubjects}},[t._v("toggle show subjects")]),t._v(" "),t._l(t.registros,(function(e,r){return s("div",{key:r,staticClass:"card results-card"},[t.showSubjects?s("div",{staticClass:"card-header",staticStyle:{padding:"1px"}},t._l(e.subjects,(function(e){return s("a",{attrs:{href:e.route}},[s("div",{staticClass:"badge badge-pill badge-black"},[t._v(t._s(e.result))])])})),0):t._e(),t._v(" "),s("a",{attrs:{href:e.route}},[s("registro-results",{attrs:{"citation-prop":e}})],1)])})),t._v(" "),s("button",{staticClass:"btn-load-more",on:{click:t.loadMore}},[t._v("Cargar Más")])],2)]):t._e()])])])}),[],!1,null,null,null).exports}}]);